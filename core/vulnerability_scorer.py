class VulnerabilityScorer:
    """
    Système de scoring pour évaluer la confiance des vulnérabilités détectées
    < 7 : pas de vulnérabilité probable
    7 : à investiguer
    8+ : faille très probable
    """
    
    def calculate_confidence_score(self, evidence):
        score = 0
        if evidence.get("direct_pattern_match"):
            score += 4
        if evidence.get("user_input_flow"):
            score += 3
        if evidence.get("dangerous_function"):
            score += 2
        if evidence.get("context_complete"):
            score += 2
        if evidence.get("sanitization_missing"):
            score += 1
        if evidence.get("sanitization_present"):
            score -= 2
        if evidence.get("ambiguous_context"):
            score -= 1
        return min(max(score, 0), 10)

    def interpret_score(self, score):
        if score < 7:
            return "PAS_VULNERABLE", "Pas de vulnérabilité probable"
        elif score == 7:
            return "A_INVESTIGUER", "Nécessite une investigation manuelle"
        else:
            return "VULNERABLE", "Faille très probablement confirmée"
